<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POS é»é¤ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- QR Code ç”Ÿæˆåº« -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    
    <!-- ç’°å¢ƒé…ç½® (å¿…é ˆåœ¨å…¶ä»–è…³æœ¬ä¹‹å‰è¼‰å…¥) -->
    <script src="public/env-config.js"></script>
</head>
<body class="bg-gray-50 font-sans">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <div class="text-center mb-8">
            <h1 id="restaurant-name" class="text-4xl font-bold text-gray-800 mb-2">é¤å»³é»é¤ç³»çµ±</h1>
            <p class="text-gray-600">æ­¡è¿ä½¿ç”¨æˆ‘å€‘çš„æ•¸ä½é»é¤æœå‹™</p>
        </div>

        <!-- ä¸»è¦ç³»çµ±å°èˆª -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
            <!-- ç®¡ç†ç³»çµ± -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-2xl font-semibold text-red-600 mb-4">ğŸ¢ ç®¡ç†ç³»çµ±</h2>
                <p class="text-gray-600 mb-4">åº—å“¡å°ˆç”¨ç®¡ç†ä»‹é¢</p>
                <div class="space-y-2">
                    <button class="w-full text-left p-2 rounded hover:bg-gray-100 transition-colors" onclick="openPage('pages/order-center.html')">ğŸ“‹ è¨‚å–®ç®¡ç†</button>
                    <button class="w-full text-left p-2 rounded hover:bg-gray-100 transition-colors" onclick="openPage('pages/management/menu-management.html')">ğŸ½ï¸ èœå–®ç®¡ç†</button>
                    <button class="w-full text-left p-2 rounded hover:bg-gray-100 transition-colors" onclick="openPage('pages/management/table-management.html')">ğŸª‘ æ¡Œæ³ç®¡ç†</button>
                    <button class="w-full text-left p-2 rounded hover:bg-gray-100 transition-colors" onclick="openPage('pages/management/purchase-management.html')">ğŸ›’ æ¡è³¼ç®¡ç†</button>
                    <button class="w-full text-left p-2 rounded hover:bg-gray-100 transition-colors" onclick="openPage('pages/management/recipe-management.html')">ğŸ‘¨â€ğŸ³ é£Ÿè­œç®¡ç†</button>
                    <button class="w-full text-left p-2 rounded hover:bg-gray-100 transition-colors" onclick="openPage('pages/management/inventory-management.html')">ğŸ“¦ åº«å­˜ç®¡ç†</button>
                    <button class="w-full text-left p-2 rounded hover:bg-gray-100 transition-colors" onclick="openPage('pages/management/cost-analysis.html')">ğŸ’° æˆæœ¬åˆ†æ</button>
                </div>
                <button class="w-full mt-4 bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors" onclick="openManagementDashboard()">é€²å…¥ç®¡ç†å¾Œå°</button>
            </div>

            <!-- å®¢æˆ¶ç«¯ç³»çµ± -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-2xl font-semibold text-blue-600 mb-4">ğŸ‘¥ å®¢æˆ¶ç«¯ç³»çµ±</h2>
                <p class="text-gray-600 mb-4">å®¢æˆ¶æœå‹™ç›¸é—œåŠŸèƒ½</p>
                <div class="space-y-2">
                    <button class="w-full text-left p-2 rounded hover:bg-gray-100 transition-colors" onclick="openPage('pages/customer/dashboard.html')">ğŸ“Š ä¸»æ§å°å„€è¡¨æ¿</button>
                    <button class="w-full text-left p-2 rounded hover:bg-gray-100 transition-colors" onclick="openPage('pages/customer/reservation.html')">ğŸ“… è¨‚ä½ç®¡ç†</button>
                    <button class="w-full text-left p-2 rounded hover:bg-gray-100 transition-colors" onclick="openPage('pages/customer/customer-view.html')">ğŸ´ å®¢æˆ¶é»é¤ä»‹é¢</button>
                    <button class="w-full text-left p-2 rounded hover:bg-gray-100 transition-colors" onclick="openPage('pages/customer/checkout-new.html')">ğŸ’³ çµå¸³ç³»çµ±</button>
                    <button class="w-full text-left p-2 rounded hover:bg-gray-100 transition-colors" onclick="openPage('public/customer/kds-new.html')">ğŸ³ å»šæˆ¿é¡¯ç¤ºç³»çµ± (KDS)</button>
                </div>
                <button class="w-full mt-4 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors" onclick="startOrdering()">é¡§å®¢é»é¤</button>
            </div>

            <!-- å·¥å…·å’Œæ¸¬è©¦ -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-2xl font-semibent text-green-600 mb-4">ğŸ”§ å·¥å…·å’Œæ¸¬è©¦</h2>
                <p class="text-gray-600 mb-4">ç³»çµ±é…ç½®èˆ‡æ¸¬è©¦å·¥å…·</p>
                <div class="space-y-2">
                    <button class="w-full text-left p-2 rounded hover:bg-gray-100 transition-colors" onclick="openPage('pages/notion-database-setup.html')">ğŸ—„ï¸ è³‡æ–™åº«è¨­å®šå·¥å…·</button>
                    <button class="w-full text-left p-2 rounded hover:bg-gray-100 transition-colors" onclick="openPage('pages/tools/csv-notion-sync.html')">ğŸ”„ CSV-Notion åŒæ­¥å·¥å…·</button>
                    <button class="w-full text-left p-2 rounded hover:bg-gray-100 transition-colors" onclick="openPage('pages/tools/system-test.html')">ğŸ§ª ç³»çµ±æ¸¬è©¦å·¥å…·</button>
                </div>
                <button class="w-full mt-4 bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors" onclick="openPage('pages/tools/')">å·¥å…·ç®±</button>
            </div>
        </div>

        <!-- ğŸ“± æ‰‹æ©Ÿå°ˆå€ -->
        <div class="mt-8">
            <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg shadow-lg p-6 border-2 border-purple-200">
                <div class="text-center mb-6">
                    <h2 class="text-3xl font-bold text-purple-800 mb-2">ğŸ“± æ‰‹æ©Ÿå°ˆå€</h2>
                    <p class="text-purple-600">å°ˆç‚ºæ‰‹æ©Ÿå„ªåŒ–çš„ç•Œé¢ï¼Œè§¸æ§å‹å¥½è¨­è¨ˆ</p>
                    <div class="mt-3 flex justify-center">
                        <span class="inline-block bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-medium">
                            ğŸ¯ è§¸æ§å„ªåŒ– â€¢ ğŸš€ å¿«é€Ÿè¼‰å…¥ â€¢ ğŸ“Š å³æ™‚æ›´æ–°
                        </span>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- æ‰‹æ©Ÿçµå¸³ç³»çµ± -->
                    <div class="bg-white rounded-lg shadow-md p-6 border border-purple-100 hover:shadow-lg transition-shadow">
                        <div class="text-center mb-4">
                            <div class="text-4xl mb-2">ğŸ’³</div>
                            <h3 class="text-xl font-semibold text-gray-800">æ‰‹æ©Ÿçµå¸³ç³»çµ±</h3>
                            <p class="text-sm text-gray-600 mt-2">å¿«é€Ÿæ¡Œä½ç®¡ç†èˆ‡çµå¸³</p>
                        </div>
                        <div class="space-y-2 text-sm text-gray-600 mb-4">
                            <div class="flex items-center">
                                <span class="w-2 h-2 bg-green-400 rounded-full mr-2"></span>
                                æ¡Œä½ç‹€æ…‹å³æ™‚æŸ¥çœ‹
                            </div>
                            <div class="flex items-center">
                                <span class="w-2 h-2 bg-blue-400 rounded-full mr-2"></span>
                                è¨‚å–®è©³æƒ…å¿«é€ŸæŸ¥è©¢
                            </div>
                            <div class="flex items-center">
                                <span class="w-2 h-2 bg-purple-400 rounded-full mr-2"></span>
                                ä¸€éµå®Œæˆçµå¸³æµç¨‹
                            </div>
                        </div>
                        <div class="space-y-2">
                            <button class="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 px-4 rounded-lg font-semibold shadow-md hover:shadow-lg transition-all transform hover:scale-105" 
                                    onclick="openMobilePage('public/customer/checkout-mobile.html')">
                                ğŸš€ é€²å…¥æ‰‹æ©Ÿçµå¸³
                            </button>
                            <div class="flex space-x-2">
                                <button class="flex-1 bg-gray-100 text-gray-700 py-2 px-3 rounded text-sm hover:bg-gray-200 transition-colors" 
                                        onclick="generateMobileQR('checkout')">
                                    ğŸ“± ç”Ÿæˆ QR
                                </button>
                                <button class="flex-1 bg-gray-100 text-gray-700 py-2 px-3 rounded text-sm hover:bg-gray-200 transition-colors" 
                                        onclick="openPage('public/customer/checkout-system-v3.html')">
                                    ğŸ’» æ¡Œé¢ç‰ˆ
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- æ‰‹æ©Ÿé»é¤ç³»çµ± -->
                    <div class="bg-white rounded-lg shadow-md p-6 border border-purple-100 hover:shadow-lg transition-shadow">
                        <div class="text-center mb-4">
                            <div class="text-4xl mb-2">ğŸ½ï¸</div>
                            <h3 class="text-xl font-semibold text-gray-800">æ‰‹æ©Ÿé»é¤ç³»çµ±</h3>
                            <p class="text-sm text-gray-600 mt-2">é¡§å®¢è‡ªåŠ©é»é¤ä»‹é¢</p>
                        </div>
                        <div class="space-y-2 text-sm text-gray-600 mb-4">
                            <div class="flex items-center">
                                <span class="w-2 h-2 bg-green-400 rounded-full mr-2"></span>
                                ç›´è§€çš„èœå–®ç€è¦½
                            </div>
                            <div class="flex items-center">
                                <span class="w-2 h-2 bg-blue-400 rounded-full mr-2"></span>
                                æ™ºæ…§è³¼ç‰©è»Šç®¡ç†
                            </div>
                            <div class="flex items-center">
                                <span class="w-2 h-2 bg-purple-400 rounded-full mr-2"></span>
                                å³æ™‚è¨‚å–®è¿½è¹¤
                            </div>
                        </div>
                        <div class="space-y-2">
                            <button class="w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-3 px-4 rounded-lg font-semibold shadow-md hover:shadow-lg transition-all transform hover:scale-105" 
                                    onclick="openMobilePage('public/customer/customer-mobile.html')">
                                ğŸ´ é€²å…¥æ‰‹æ©Ÿé»é¤
                            </button>
                            <div class="flex space-x-2">
                                <button class="flex-1 bg-gray-100 text-gray-700 py-2 px-3 rounded text-sm hover:bg-gray-200 transition-colors" 
                                        onclick="generateMobileQR('customer')">
                                    ğŸ“± ç”Ÿæˆ QR
                                </button>
                                <button class="flex-1 bg-gray-100 text-gray-700 py-2 px-3 rounded text-sm hover:bg-gray-200 transition-colors" 
                                        onclick="openPage('public/customer/customer-view.html')">
                                    ğŸ’» æ¡Œé¢ç‰ˆ
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- æ‰‹æ©Ÿå»šæˆ¿ç³»çµ± -->
                    <div class="bg-white rounded-lg shadow-md p-6 border border-purple-100 hover:shadow-lg transition-shadow">
                        <div class="text-center mb-4">
                            <div class="text-4xl mb-2">ğŸ‘¨â€ğŸ³</div>
                            <h3 class="text-xl font-semibold text-gray-800">æ‰‹æ©Ÿå»šæˆ¿ç³»çµ±</h3>
                            <p class="text-sm text-gray-600 mt-2">å»šæˆ¿è¨‚å–®ç®¡ç†ç•Œé¢</p>
                        </div>
                        <div class="space-y-2 text-sm text-gray-600 mb-4">
                            <div class="flex items-center">
                                <span class="w-2 h-2 bg-green-400 rounded-full mr-2"></span>
                                æ–°è¨‚å–®å³æ™‚é€šçŸ¥
                            </div>
                            <div class="flex items-center">
                                <span class="w-2 h-2 bg-blue-400 rounded-full mr-2"></span>
                                è¨‚å–®ç‹€æ…‹å¿«é€Ÿæ›´æ–°
                            </div>
                            <div class="flex items-center">
                                <span class="w-2 h-2 bg-purple-400 rounded-full mr-2"></span>
                                æ™ºæ…§æ™‚é–“ç®¡ç†
                            </div>
                        </div>
                        <div class="space-y-2">
                            <button class="w-full bg-gradient-to-r from-orange-500 to-orange-600 text-white py-3 px-4 rounded-lg font-semibold shadow-md hover:shadow-lg transition-all transform hover:scale-105" 
                                    onclick="openMobilePage('public/customer/kds-mobile.html')">
                                ğŸ”¥ é€²å…¥æ‰‹æ©Ÿå»šæˆ¿
                            </button>
                            <div class="flex space-x-2">
                                <button class="flex-1 bg-gray-100 text-gray-700 py-2 px-3 rounded text-sm hover:bg-gray-200 transition-colors" 
                                        onclick="generateMobileQR('kds')">
                                    ğŸ“± ç”Ÿæˆ QR
                                </button>
                                <button class="flex-1 bg-gray-100 text-gray-700 py-2 px-3 rounded text-sm hover:bg-gray-200 transition-colors" 
                                        onclick="openPage('public/customer/kds-new.html')">
                                    ğŸ’» æ¡Œé¢ç‰ˆ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æ‰‹æ©Ÿå°ˆå€æç¤º -->
                <div class="mt-6 bg-white bg-opacity-70 rounded-lg p-4 border border-purple-200">
                    <div class="flex items-start space-x-3">
                        <div class="text-2xl">ğŸ’¡</div>
                        <div>
                            <h4 class="font-semibold text-purple-800 mb-1">ä½¿ç”¨æç¤º</h4>
                            <ul class="text-sm text-purple-700 space-y-1">
                                <li>â€¢ é»æ“Šã€ŒğŸ“± ç”Ÿæˆ QRã€å¯ç”¢ç”Ÿæ‰‹æ©Ÿå°ˆç”¨äºŒç¶­ç¢¼</li>
                                <li>â€¢ æ‰‹æ©Ÿç•Œé¢æ”¯æ´è§¸æ§æ‰‹å‹¢å’Œå¿«æ·æ“ä½œ</li>
                                <li>â€¢ å»ºè­°å°‡æ‰‹æ©Ÿé é¢åŠ å…¥æ›¸ç±¤ä»¥ä¾¿å¿«é€Ÿå­˜å–</li>
                                <li>â€¢ æ‰€æœ‰æ‰‹æ©Ÿç‰ˆæœ¬éƒ½æ”¯æ´å³æ™‚è³‡æ–™åŒæ­¥</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- QR Code ç”Ÿæˆå€åŸŸ -->
        <div class="mt-8">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">æ¡Œè™Ÿ QR Code ç”Ÿæˆ</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">é¸æ“‡æ¡Œè™Ÿ:</label>
                        <select id="tableSelect" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="">è«‹é¸æ“‡æ¡Œè™Ÿ</option>
                        </select>
                        <button class="mt-4 bg-purple-500 text-white px-6 py-3 rounded-lg hover:bg-purple-600 transition-colors w-full" onclick="generateQRCode()">ç”Ÿæˆ QR Code</button>
                    </div>
                    <div class="text-center">
                        <div id="qrcode" class="inline-block p-4 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300 min-h-[200px] flex items-center justify-center">
                            <p class="text-gray-500">é¸æ“‡æ¡Œè™Ÿå¾Œç”Ÿæˆ QR Code</p>
                        </div>
                        <button id="downloadBtn" class="mt-4 bg-indigo-500 text-white px-6 py-2 rounded-lg hover:bg-indigo-600 transition-colors hidden" onclick="downloadQRCode()">ä¸‹è¼‰ QR Code</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="mt-8">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">ç³»çµ±ç‹€æ…‹</h2>
                <div id="system-status">
                    <p class="text-gray-600">æ­£åœ¨æª¢æŸ¥ç³»çµ±é€£ç·š...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // åˆå§‹åŒ–æ‡‰ç”¨ç¨‹å¼
        function initApp() {
            // è¨­ç½®é¤å»³åç¨±
            if (window.ENV_CONFIG && window.ENV_CONFIG.RESTAURANT_NAME) {
                document.getElementById('restaurant-name').textContent = window.ENV_CONFIG.RESTAURANT_NAME;
                document.title = window.ENV_CONFIG.RESTAURANT_NAME + ' - é»é¤ç³»çµ±';
            }

            // åˆå§‹åŒ–æ¡Œè™Ÿé¸é …
            initTableOptions();

            // æª¢æŸ¥ç³»çµ±ç‹€æ…‹
            checkSystemStatus();
        }

        // åˆå§‹åŒ–æ¡Œè™Ÿé¸é …
        function initTableOptions() {
            const tableSelect = document.getElementById('tableSelect');
            // ç”Ÿæˆ 1-20 æ¡Œçš„é¸é …
            for (let i = 1; i <= 20; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `${i} è™Ÿæ¡Œ`;
                tableSelect.appendChild(option);
            }
        }

        // ç”Ÿæˆ QR Code
        function generateQRCode() {
            const tableNumber = document.getElementById('tableSelect').value;
            if (!tableNumber) {
                alert('è«‹å…ˆé¸æ“‡æ¡Œè™Ÿ');
                return;
            }

            // æ§‹å»ºé»é¤ URL
            const baseUrl = window.location.origin;
            const orderUrl = `${baseUrl}/customer/?table=${tableNumber}`;
            
            // æ¸…ç©ºèˆŠçš„ QR Code
            const qrContainer = document.getElementById('qrcode');
            qrContainer.innerHTML = '';

            // ç”Ÿæˆæ–°çš„ QR Code
            QRCode.toCanvas(qrContainer, orderUrl, {
                width: 200,
                height: 200,
                colorDark: '#000000',
                colorLight: '#ffffff',
                margin: 2,
                errorCorrectionLevel: 'H'
            }, function (error) {
                if (error) {
                    console.error('QR Code ç”Ÿæˆå¤±æ•—:', error);
                    qrContainer.innerHTML = '<p class="text-red-500">QR Code ç”Ÿæˆå¤±æ•—</p>';
                } else {
                    console.log('QR Code ç”ŸæˆæˆåŠŸ!');
                    // é¡¯ç¤ºä¸‹è¼‰æŒ‰éˆ•
                    document.getElementById('downloadBtn').classList.remove('hidden');
                    
                    // æ·»åŠ æ¡Œè™Ÿæ¨™ç±¤
                    const label = document.createElement('p');
                    label.className = 'mt-2 font-semibold text-gray-800';
                    label.textContent = `${tableNumber} è™Ÿæ¡Œ`;
                    qrContainer.appendChild(label);
                }
            });
        }

        // ä¸‹è¼‰ QR Code
        function downloadQRCode() {
            const canvas = document.querySelector('#qrcode canvas');
            if (!canvas) {
                alert('è«‹å…ˆç”Ÿæˆ QR Code');
                return;
            }

            const tableNumber = document.getElementById('tableSelect').value;
            const link = document.createElement('a');
            link.download = `æ¡Œè™Ÿ${tableNumber}_QRCode.png`;
            link.href = canvas.toDataURL();
            link.click();
        }

        // æ–°å¢é é¢å°èˆªåŠŸèƒ½
        function openPage(pagePath) {
            // æª¢æŸ¥æ˜¯å¦éœ€è¦å¯†ç¢¼é©—è­‰ï¼ˆç®¡ç†ç³»çµ±é é¢ï¼‰
            if (pagePath.includes('management/')) {
                const password = prompt('è«‹è¼¸å…¥ç®¡ç†å¯†ç¢¼ï¼š');
                if (password !== 'admin123') {
                    if (password) {
                        alert('å¯†ç¢¼éŒ¯èª¤');
                    }
                    return;
                }
            }
            
            // é–‹å•Ÿé é¢
            window.open(pagePath, '_blank');
        }

        function openManagementDashboard() {
            const password = prompt('è«‹è¼¸å…¥ç®¡ç†å¯†ç¢¼ï¼š');
            if (password === 'admin123') {
                window.open('pages/management/dashboard.html', '_blank');
            } else if (password) {
                alert('å¯†ç¢¼éŒ¯èª¤');
            }
        }

        function checkSystemStatus() {
            const statusDiv = document.getElementById('system-status');
            
            if (window.ENV_CONFIG) {
                const hasRequiredConfig = window.ENV_CONFIG.NOTION_API_KEY && 
                                        window.ENV_CONFIG.MENU_DATABASE_ID;
                
                if (hasRequiredConfig) {
                    statusDiv.innerHTML = '<div class="bg-green-100 text-green-800 p-3 rounded">âœ… ç³»çµ±é‹è¡Œæ­£å¸¸</div>';
                } else {
                    statusDiv.innerHTML = '<div class="bg-yellow-100 text-yellow-800 p-3 rounded">âš ï¸ ç³»çµ±é…ç½®ä¸å®Œæ•´ï¼Œè«‹è¯ç¹«æŠ€è¡“æ”¯æ´</div>';
                }
            } else {
                statusDiv.innerHTML = '<div class="bg-red-100 text-red-800 p-3 rounded">âŒ ç„¡æ³•è¼‰å…¥ç³»çµ±é…ç½®</div>';
            }
        }

        function startOrdering() {
            const tableNumber = prompt('è«‹è¼¸å…¥æ¡Œè™Ÿ (1-20):');
            if (tableNumber && tableNumber >= 1 && tableNumber <= 20) {
                const orderUrl = `${window.location.origin}/customer/?table=${tableNumber}`;
                window.open(orderUrl, '_blank');
            } else if (tableNumber) {
                alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„æ¡Œè™Ÿ (1-20)');
            }
        }

        function openManagement() {
            // ä¿ç•™åŸæœ‰çš„ç®¡ç†åŠŸèƒ½ï¼Œç¾åœ¨é‡å®šå‘åˆ°ç®¡ç†å„€è¡¨æ¿
            openManagementDashboard();
        }

        // === æ‰‹æ©Ÿå°ˆå€åŠŸèƒ½ ===
        function openMobilePage(pagePath) {
            // ä½¿ç”¨ç•¶å‰è¦–çª—é–‹å•Ÿæ‰‹æ©Ÿé é¢ï¼Œå› ç‚ºæ‰‹æ©Ÿé é¢é€šå¸¸æ‡‰è©²å…¨è¢å¹•é¡¯ç¤º
            const width = window.screen.width;
            const isMobile = width <= 768;
            
            if (isMobile) {
                // åœ¨æ‰‹æ©Ÿè¨­å‚™ä¸Šï¼Œç›´æ¥åœ¨ç•¶å‰è¦–çª—é–‹å•Ÿ
                window.location.href = pagePath;
            } else {
                // åœ¨æ¡Œé¢è¨­å‚™ä¸Šï¼Œé–‹å•Ÿæ‰‹æ©Ÿå°ºå¯¸çš„æ–°è¦–çª—
                const mobileWindow = window.open(
                    pagePath, 
                    '_blank',
                    'width=375,height=812,scrollbars=yes,resizable=yes,toolbar=no,menubar=no,location=no,status=no'
                );
                
                if (mobileWindow) {
                    mobileWindow.focus();
                } else {
                    // å¦‚æœå½ˆå‡ºè¦–çª—è¢«é˜»æ“‹ï¼Œå‰‡åœ¨æ–°æ¨™ç±¤é é–‹å•Ÿ
                    window.open(pagePath, '_blank');
                }
            }
        }

        function generateMobileQR(systemType) {
            let title, url, color;
            
            switch (systemType) {
                case 'checkout':
                    title = 'æ‰‹æ©Ÿçµå¸³ç³»çµ±';
                    url = `${window.location.origin}/public/customer/checkout-mobile.html`;
                    color = '#3b82f6'; // blue
                    break;
                case 'customer':
                    title = 'æ‰‹æ©Ÿé»é¤ç³»çµ±';
                    url = `${window.location.origin}/public/customer/customer-mobile.html`;
                    color = '#16a34a'; // green
                    break;
                case 'kds':
                    title = 'æ‰‹æ©Ÿå»šæˆ¿ç³»çµ±';
                    url = `${window.location.origin}/public/customer/kds-mobile.html`;
                    color = '#ea580c'; // orange
                    break;
                default:
                    alert('æœªçŸ¥çš„ç³»çµ±é¡å‹');
                    return;
            }

            // å‰µå»ºæ‰‹æ©Ÿå°ˆç”¨ QR ç¢¼æ¨¡æ…‹æ¡†
            showMobileQRModal(title, url, color);
        }

        function showMobileQRModal(title, url, color) {
            // å‰µå»ºæ¨¡æ…‹æ¡† HTML
            const modalHTML = `
                <div id="mobileQRModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" onclick="closeMobileQRModal(event)">
                    <div class="bg-white rounded-lg p-6 max-w-md w-full" onclick="event.stopPropagation()">
                        <div class="text-center">
                            <h3 class="text-xl font-semibold mb-4" style="color: ${color}">${title}</h3>
                            <div id="mobileQRCode" class="inline-block p-4 bg-gray-50 rounded-lg border-2" style="border-color: ${color}">
                                <div class="flex items-center justify-center" style="width: 200px; height: 200px;">
                                    <div class="loading-spinner" style="border-top-color: ${color}"></div>
                                </div>
                            </div>
                            <p class="text-sm text-gray-600 mt-4 mb-4">æƒæäºŒç¶­ç¢¼é–‹å•Ÿæ‰‹æ©Ÿå°ˆç”¨ç•Œé¢</p>
                            <div class="space-y-2">
                                <button onclick="downloadMobileQR('${title}')" class="w-full bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors">
                                    ğŸ“± ä¸‹è¼‰ QR ç¢¼
                                </button>
                                <button onclick="copyMobileUrl('${url}')" class="w-full bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors">
                                    ğŸ”— è¤‡è£½ç¶²å€
                                </button>
                                <button onclick="closeMobileQRModal()" class="w-full text-gray-500 py-2 px-4 rounded-lg hover:bg-gray-50 transition-colors">
                                    é—œé–‰
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // æ’å…¥æ¨¡æ…‹æ¡†åˆ°é é¢
            document.body.insertAdjacentHTML('beforeend', modalHTML);

            // ç”Ÿæˆ QR ç¢¼
            const qrContainer = document.getElementById('mobileQRCode');
            qrContainer.innerHTML = '';

            QRCode.toCanvas(qrContainer, url, {
                width: 200,
                height: 200,
                colorDark: color,
                colorLight: '#ffffff',
                margin: 2,
                errorCorrectionLevel: 'H'
            }, function (error) {
                if (error) {
                    console.error('QR Code ç”Ÿæˆå¤±æ•—:', error);
                    qrContainer.innerHTML = '<p class="text-red-500 text-sm">QR Code ç”Ÿæˆå¤±æ•—</p>';
                } else {
                    console.log('æ‰‹æ©Ÿ QR Code ç”ŸæˆæˆåŠŸ!');
                }
            });
        }

        function closeMobileQRModal(event) {
            if (event && event.target.id !== 'mobileQRModal') return;
            
            const modal = document.getElementById('mobileQRModal');
            if (modal) {
                modal.remove();
            }
        }

        function downloadMobileQR(systemTitle) {
            const canvas = document.querySelector('#mobileQRCode canvas');
            if (!canvas) {
                alert('QR ç¢¼å°šæœªç”Ÿæˆå®Œæˆï¼Œè«‹ç¨å€™å†è©¦');
                return;
            }

            const link = document.createElement('a');
            link.download = `${systemTitle}_æ‰‹æ©Ÿç‰ˆ_QRCode.png`;
            link.href = canvas.toDataURL();
            link.click();
        }

        function copyMobileUrl(url) {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(url).then(() => {
                    showCopySuccess();
                }).catch(() => {
                    fallbackCopy(url);
                });
            } else {
                fallbackCopy(url);
            }
        }

        function fallbackCopy(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.opacity = '0';
            document.body.appendChild(textArea);
            textArea.select();
            
            try {
                document.execCommand('copy');
                showCopySuccess();
            } catch (err) {
                prompt('è«‹æ‰‹å‹•è¤‡è£½ä»¥ä¸‹ç¶²å€:', text);
            }
            
            document.body.removeChild(textArea);
        }

        function showCopySuccess() {
            // å‰µå»ºæˆåŠŸæç¤º
            const successHTML = `
                <div id="copySuccess" class="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 transform transition-all duration-300">
                    âœ… ç¶²å€å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', successHTML);
            
            // 3ç§’å¾Œè‡ªå‹•ç§»é™¤
            setTimeout(() => {
                const successElement = document.getElementById('copySuccess');
                if (successElement) {
                    successElement.remove();
                }
            }, 3000);
        }

        // æª¢æ¸¬è¨­å‚™é¡å‹
        function detectDevice() {
            const width = window.innerWidth;
            const userAgent = navigator.userAgent;
            const isMobile = width <= 768 || /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);
            
            if (isMobile) {
                // ç‚ºæ‰‹æ©Ÿç”¨æˆ¶æ·»åŠ ç‰¹æ®Šæ¨£å¼æç¤º
                const mobileNotice = document.createElement('div');
                mobileNotice.className = 'fixed bottom-4 left-4 right-4 bg-purple-100 border border-purple-300 rounded-lg p-3 text-sm text-purple-800 z-40';
                mobileNotice.innerHTML = `
                    <div class="flex items-center">
                        <span class="text-lg mr-2">ğŸ“±</span>
                        <div>
                            <strong>æ‰‹æ©Ÿç”¨æˆ¶å°ˆå€ï¼š</strong>å»ºè­°ä½¿ç”¨ä¸Šæ–¹ã€ŒğŸ“± æ‰‹æ©Ÿå°ˆå€ã€ç²å¾—æœ€ä½³é«”é©—ï¼
                            <button onclick="this.parentElement.parentElement.parentElement.remove()" class="ml-2 text-purple-600 hover:text-purple-800">Ã—</button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(mobileNotice);
                
                // 5ç§’å¾Œè‡ªå‹•éš±è—
                setTimeout(() => {
                    if (mobileNotice.parentElement) {
                        mobileNotice.remove();
                    }
                }, 5000);
            }
        }

        // åŠ è¼‰ CSS æ¨£å¼
        function addMobileStyles() {
            const styles = `
                <style>
                    .loading-spinner {
                        display: inline-block;
                        width: 20px;
                        height: 20px;
                        border: 2px solid #f3f3f3;
                        border-top: 2px solid #3b82f6;
                        border-radius: 50%;
                        animation: spin 1s linear infinite;
                    }
                    @keyframes spin {
                        0% { transform: rotate(0deg); }
                        100% { transform: rotate(360deg); }
                    }
                    @media (max-width: 768px) {
                        .grid-cols-1.md\\:grid-cols-3 {
                            grid-template-columns: 1fr;
                        }
                    }
                </style>
            `;
            document.head.insertAdjacentHTML('beforeend', styles);
        }

        // ä¿®æ”¹åŸæœ‰çš„åˆå§‹åŒ–å‡½æ•¸
        function initApp() {
            // è¨­ç½®é¤å»³åç¨±
            if (window.ENV_CONFIG && window.ENV_CONFIG.RESTAURANT_NAME) {
                document.getElementById('restaurant-name').textContent = window.ENV_CONFIG.RESTAURANT_NAME;
                document.title = window.ENV_CONFIG.RESTAURANT_NAME + ' - é»é¤ç³»çµ±';
            }

            // åˆå§‹åŒ–æ¡Œè™Ÿé¸é …
            initTableOptions();

            // æª¢æŸ¥ç³»çµ±ç‹€æ…‹
            checkSystemStatus();

            // åŠ è¼‰æ‰‹æ©Ÿæ¨£å¼
            addMobileStyles();

            // æª¢æ¸¬è¨­å‚™ä¸¦é¡¯ç¤ºç›¸æ‡‰æç¤º
            setTimeout(detectDevice, 1000);
        }

        // é é¢è¼‰å…¥å®Œæˆå¾Œåˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
