# Notion é£Ÿæåº« API æ˜ å°„ç¢ºèªå ±å‘Š

## ğŸ“‹ è³‡æ–™åº«è³‡è¨Š
- **è³‡æ–™åº«ID**: `237fd5adc30b808cbba3c03f8f2065fd`
- **è³‡æ–™åº«åç¨±**: é£Ÿæåº«
- **API ç«¯é»**: `/api/notion/databases/237fd5adc30b808cbba3c03f8f2065fd/query`
- **æ¸¬è©¦æ—¥æœŸ**: 2025å¹´7æœˆ25æ—¥

## âœ… æ¬„ä½æ˜ å°„ç¢ºèª

### Notion è³‡æ–™åº«åŸå§‹æ¬„ä½ â¡ï¸ ç³»çµ±å…§éƒ¨æ¬„ä½

| Notion æ¬„ä½åç¨± | æ¬„ä½é¡å‹ | ç³»çµ±æ˜ å°„æ¬„ä½ | æ˜ å°„é‚è¼¯ |
|----------------|----------|-------------|----------|
| `å“é …ID` | title | `itemId` | ä¸»è¦å“é …è­˜åˆ¥ç¢¼ï¼Œä½œç‚º title æ¬„ä½ |
| `é£Ÿæåç¨±` | rich_text | `name` | é£Ÿæçš„é¡¯ç¤ºåç¨± |
| `ä¾›æ‡‰å•†` | select | `supplier` | ä¾›æ‡‰å•†åç¨± |
| `è¦æ ¼/å–®ä½` | rich_text | `specification` + `unit` | åŒæ™‚æä¾›è¦æ ¼è³‡è¨Šä¸¦è§£æå–®ä½ |
| `åº«å­˜é‡` | number | `stock` | ç•¶å‰åº«å­˜æ•¸é‡ |
| `å®‰å…¨åº«å­˜é‡` | number | `safetyStock` | å®‰å…¨åº«å­˜è­¦æˆ’ç·š |
| `é€²åƒ¹` | number | `purchasePrice` | æ¡è³¼åƒ¹æ ¼ |
| `å–®ä½æˆæœ¬` | formula | `unitCost` | è¨ˆç®—å¾Œçš„å–®ä½æˆæœ¬ |
| `å“é …é¡åˆ¥` | select | `category` | é£Ÿæåˆ†é¡ |
| `æœ€å¾Œé€²è²¨æ—¥` | last_edited_time | `lastPurchase` | æœ€å¾Œé€²è²¨æ—¥æœŸ |
| `ç‹€æ…‹` | status | `notes` | é …ç›®ç‹€æ…‹è³‡è¨Š |
| `ç¸½é€²è²¨é‡` | rollup | `totalPurchase` | ç´¯è¨ˆé€²è²¨é‡ |

## ğŸ”„ å–®ä½è™•ç†é‚è¼¯

### å–®ä½è§£æè¦å‰‡
```javascript
const specText = properties['è¦æ ¼/å–®ä½']?.rich_text?.[0]?.text?.content || '';
const unitMatch = specText.match(/(å…‹|å…¬æ–¤|æ¯«å‡|å…¬å‡|é¡†|æ–¤|åŒ…|ç“¶|ç½)/);
const extractedUnit = unitMatch ? unitMatch[1] : 'å…¬å…‹';
```

### é‡é‡æ ¼å¼åŒ–è¦å‰‡
- **< 1000å…¬å…‹**: é¡¯ç¤ºç‚º "XXX å…¬å…‹"
- **â‰¥ 1000å…¬å…‹**: è‡ªå‹•è½‰æ›ç‚º "X.X å…¬æ–¤"

## ğŸ“Š æ¸¬è©¦çµæœ

### æˆåŠŸæ¡ˆä¾‹æ¸¬è©¦
1. âœ… **æª¸æª¬è‘‰ä¹¾** - 50å…¬å…‹åº«å­˜ï¼Œæ³“æ½”ä¾›æ‡‰å•†
2. âœ… **é¦™èŒ…ä¹¾** - 100å…¬å…‹åº«å­˜ï¼Œæ³“æ½”ä¾›æ‡‰å•†  
3. âœ… **è‚‹æ¢è‚‰** - 0åº«å­˜ï¼ˆç¼ºè²¨ç‹€æ…‹ï¼‰ï¼Œæ´‹åŸºä¾›æ‡‰å•†
4. âœ… **å«©ç²¾** - 300å…¬å…‹åº«å­˜ï¼Œä½³è‰¯è¡Œä¾›æ‡‰å•†
5. âœ… **ç‰ç±³å¡Š** - 6000å…¬å…‹åº«å­˜ï¼ˆé¡¯ç¤ºç‚º6å…¬æ–¤ï¼‰ï¼Œæ±è‰ä¾›æ‡‰å•†

### åº«å­˜ç‹€æ…‹é‚è¼¯
```javascript
function getStockStatus(stock, safetyStock) {
    if (stock === 0) return 'critical';      // ç¼ºè²¨
    if (stock <= safetyStock) return 'low';   // åº«å­˜åä½
    return 'safe';                            // åº«å­˜å……è¶³
}
```

## ğŸ”§ æŠ€è¡“å¯¦ç¾

### API å‘¼å«æ–¹å¼
```javascript
const response = await fetch('/api/notion/databases/237fd5adc30b808cbba3c03f8f2065fd/query', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({})
});
```

### è³‡æ–™è½‰æ›æµç¨‹
1. **API å‘¼å«** â†’ ç²å– Notion åŸå§‹è³‡æ–™
2. **æ¬„ä½æ˜ å°„** â†’ è½‰æ›ç‚ºç³»çµ±å…§éƒ¨æ ¼å¼  
3. **å–®ä½è§£æ** â†’ å¾è¦æ ¼æ¬„ä½æå–å–®ä½è³‡è¨Š
4. **é‡é‡æ ¼å¼åŒ–** â†’ æ™ºèƒ½é¡¯ç¤ºå…¬å…‹/å…¬æ–¤
5. **ç‹€æ…‹è¨ˆç®—** â†’ æ ¹æ“šåº«å­˜é‡è¨ˆç®—ç‹€æ…‹
6. **UI æ¸²æŸ“** â†’ é¡¯ç¤ºåœ¨åº«å­˜ç®¡ç†ç•Œé¢

## ğŸ“ ç›¸é—œæª”æ¡ˆ

- **ä¸»è¦é‚è¼¯**: `assets/js/inventory-management.js` (line 54-78)
- **æ¸¬è©¦é é¢**: `pages/management/inventory-management.html`
- **æ˜ å°„æ¸¬è©¦**: `test-notion-mapping.html`
- **ä¼ºæœå™¨ä»£ç†**: `server.js` (Notion API ä»£ç†)

## ğŸ¯ çµè«–

âœ… **Notion API é£Ÿæåº«æ˜ å°„å®Œå…¨æˆåŠŸ**
- æ‰€æœ‰å¿…è¦æ¬„ä½æ­£ç¢ºæ˜ å°„
- é‡é‡å–®ä½æ™ºèƒ½è½‰æ›é‹ä½œæ­£å¸¸
- åº«å­˜ç‹€æ…‹åˆ¤æ–·é‚è¼¯æ­£ç¢º
- UI é¡¯ç¤ºæ ¼å¼åŒ–å®Œå–„

**ç³»çµ±ç¾åœ¨å¯ä»¥æ­£ç¢ºå¾ Notion é£Ÿæåº«è¼‰å…¥è³‡æ–™ä¸¦ä»¥ä½¿ç”¨è€…å‹å–„çš„æ ¼å¼é¡¯ç¤ºï¼** ğŸ‰
