# CSV 到 Notion 同步指南

## 📋 功能說明

這個工具可以將 `data/最終菜色.csv` 檔案中的菜單資料同步到 Notion 菜單資料庫中。

## 🚀 快速開始

### 方法 1：使用批次檔案（推薦）

1. 雙擊執行 `start-csv-sync.bat`
2. 系統會自動：
   - 檢查環境設定
   - 啟動代理伺服器
   - 開啟同步工具網頁

### 方法 2：手動啟動

1. 開啟命令提示字元
2. 進入專案目錄：
   ```cmd
   cd "c:\Users\fiend\OneDrive\桌面2\tanawat-order-api-main"
   ```
3. 啟動伺服器：
   ```cmd
   npm start
   ```
4. 開啟瀏覽器訪問：
   ```
   http://localhost:3000/pages/tools/csv-notion-sync.html
   ```

## 📊 使用步驟

### 1. 預覽 CSV 資料
- 點擊 **「📋 預覽 CSV 資料」** 按鈕
- 查看將要同步的菜單項目
- 確認資料格式正確

### 2. 開始同步
- 點擊 **「🚀 開始同步到 Notion」** 按鈕
- 系統會逐筆處理每個菜單項目
- 進度條會顯示同步進度
- 日誌區會顯示詳細處理結果

### 3. 查看結果
- 成功同步的項目數量
- 失敗項目的錯誤訊息
- 整體統計資訊

## 🔧 資料對應關係

CSV 欄位對應到 Notion 資料庫屬性：

| CSV 欄位 | Notion 屬性 | 資料類型 | 說明 |
|---------|------------|---------|------|
| 餐點名稱 | 餐點名稱 | Title | 主要標題 |
| 餐點類型 | 餐點類型 | Select | 分類選項 |
| 價格 | 價格 | Number | 售價 |
| 成本 | 成本 | Number | 成本價 |
| 庫存量 | 庫存量 | Number | 當前庫存 |
| 安全庫存量 | 安全庫存量 | Number | 最低庫存警告 |
| 可供應庫存量 | 可供應庫存量 | Number | 可供應數量 |
| 無法供應 | 供應狀態 | Checkbox | Yes=不可供應, No=可供應 |
| 餐點介紹 | 餐點介紹 | Rich Text | 描述文字 |
| 辣度 | 辣度 | Select | 辣度等級 |
| 辣度選項 | 辣度選項 | Multi Select | 可選辣度 |
| 冰量選項 | 冰量選項 | Multi Select | 可選冰量 |
| 甜度選項 | 甜度選項 | Multi Select | 可選甜度 |
| 製作方式 | 製作方式 | Select | 烹飪方法 |
| 製作地點 | 製作地點 | Select | 製作區域 |
| 過敏原 | 過敏原 | Rich Text | 過敏原資訊 |
| 推薦 | 推薦 | Checkbox | 是否推薦 |
| 菜單組成項目 | 菜單組成項目 | Rich Text | 組成成分 |

## ⚠️ 注意事項

### 1. 同步前準備
- 確保 Notion API Key 已正確設定
- 確保菜單資料庫 ID 正確
- 檢查 CSV 檔案格式無誤

### 2. 同步過程
- 同步過程中請勿關閉瀏覽器
- 系統會自動控制 API 請求頻率
- 大量資料同步可能需要幾分鐘時間

### 3. 錯誤處理
- 如遇到錯誤，檢查日誌區的詳細資訊
- 常見錯誤：API 限制、資料格式問題、網路連線
- 可以重新執行同步，系統會跳過已同步的資料

## 🛠️ 進階功能

### 清空資料庫
- 使用 **「🗑️ 清空 Notion 資料庫」** 功能
- ⚠️ 此操作無法復原，請謹慎使用
- 主要用於重新同步時清理舊資料

### 批次處理
- 系統自動分批處理大量資料
- 避免 Notion API 限制
- 確保同步穩定性

## 📊 同步統計

工具會顯示以下統計資訊：
- **總計項目**：CSV 中的菜單總數
- **可供應項目**：狀態為可供應的項目數
- **平均價格**：所有項目的平均售價
- **已同步項目**：成功同步到 Notion 的項目數

## 🔍 故障排除

### 1. 伺服器無法啟動
- 檢查 Port 3000 是否被占用
- 確認 Node.js 已正確安裝
- 檢查專案路徑是否正確

### 2. CSV 讀取失敗
- 確認 `data/最終菜色.csv` 檔案存在
- 檢查檔案編碼為 UTF-8
- 確認 CSV 格式正確

### 3. Notion 連線失敗
- 檢查網路連線
- 確認 API Key 有效
- 檢查資料庫 ID 正確

### 4. 同步失敗
- 查看日誌區的錯誤訊息
- 檢查 Notion 資料庫權限
- 確認資料格式符合 Notion 要求

## 📞 技術支援

如遇到問題，請檢查：
1. 日誌檔案的錯誤訊息
2. 瀏覽器開發者工具的 Console
3. 伺服器終端機的輸出訊息

## 🎯 最佳實踐

1. **同步前備份**：建議在同步前備份 Notion 資料庫
2. **分批同步**：大量資料建議分批同步
3. **定期檢查**：定期檢查同步結果的正確性
4. **監控限制**：注意 Notion API 的使用限制

---

📅 最後更新：2025年7月25日  
🔧 版本：v1.0  
👨‍💻 作者：GitHub Copilot
