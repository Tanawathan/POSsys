# POS 系統 Notion 資料庫映射配置

## 📊 根據實際 Notion 資料庫結構重新配置

### 🔍 檢查結果摘要

**檢查時間**: 2025年7月25日
**檢查方法**: 使用 Notion API 直接查詢資料庫結構

---

## 🏪 桌況資料庫 (Tables) - ID: 23afd5adc30b80fe86c9e086a54a0d61

### 📋 欄位結構
| 欄位名稱 | 類型 | 用途 | 備註 |
|---------|------|------|------|
| 桌號 | Title | 主鍵識別 | 如: "前右2", "方6" |
| 狀態 | Select | 桌位狀態 | 選項: 空閒中, 使用中, 清理中, 維修中, 已預訂, 暫停使用 |
| 容納人數 | Number | 最大容納人數 | 預設: 4 |
| 目前人數 | Number | 當前入座人數 | 預設: 0 |
| 位置 | Rich Text | 桌位位置描述 | |
| 區域 | Select | 餐廳區域 | 選項: 前區, 中區, 後區, 包廂, 戶外, VIP |
| 桌型 | Select | 桌子形狀 | 選項: 方形, 圓形, 長形, 吧台, 不規則 |
| 備註 | Rich Text | 額外說明 | |
| 目前訂單 | Rich Text | 當前訂單資訊 | |
| 目前消費 | Number | 目前消費金額 | |
| 可使用 | Checkbox | 是否可用 | |
| 入座時間 | Date | 客人入座時間 | |
| 優先序 | Number | 排序優先級 | |
| 主桌 | Checkbox | 是否為主桌 | |
| 併桌備註 | Rich Text | 併桌相關說明 | |
| 最後清潔時間 | Date | 上次清潔時間 | |
| 特色 | Multi Select | 桌位特色 | 選項: 靠窗, 景觀佳, 安靜, 情侶座等 |

---

## 📝 訂單資料庫 (Orders) - ID: 23afd5adc30b80c39e71d1a640ccfb5d

### 📋 欄位結構
| 欄位名稱 | 類型 | 用途 | 備註 |
|---------|------|------|------|
| 訂單編號 | Title | 主鍵識別 | 格式: "桌號-時間戳" |
| 桌號 | Number | 桌位編號 | **重要**: 必須為數字 |
| 桌號 1 | Rich Text | 完整桌號描述 | 保存原始桌號字串 |
| 狀態 | Select | 訂單狀態 | 選項: 待處理, 製作中, 已完成, 已取消, 進行中 |
| 總金額 | Number | 訂單總金額 | |
| 訂單項目 | Rich Text | 餐點明細 | JSON 或文字格式 |
| 建立時間 | Date | 訂單建立時間 | ISO 格式 |
| 訂單時間 | Date | 備用時間欄位 | |
| 備註 | Rich Text | 訂單備註 | |
| 用餐人數 | Number | 用餐人數 | |
| 服務生 | Rich Text | 負責服務生 | |
| 付款狀態 | Select | 付款狀態 | 選項: 未付款, 部分付款, 已付款 |
| 付款方式 | Select | 付款方式 | 選項: 現金, 信用卡, 行動支付 |

---

## 🍽️ 菜單資料庫 (Menu) - ID: 23afd5adc30b80c58355fd93d05c66d6

### 📋 欄位結構
| 欄位名稱 | 類型 | 用途 | 備註 |
|---------|------|------|------|
| 名稱 | Title | 餐點名稱 | 主鍵 |
| 分類 | Select | 餐點分類 | 選項: 主食, 開胃菜, 湯品, 甜點, 飲品, 沙拉, 小菜 |
| 價格 | Number | 餐點價格 | |
| 描述 | Rich Text | 餐點描述 | |
| 供應狀態 | Checkbox | 是否供應 | true=供應中, false=暫停供應 |

---

## 🔧 POS 系統配置更新

### 主要變更:

1. **桌號智能處理**:
   ```javascript
   // 從 "前右2" 提取數字 "2" 存入桌號欄位
   // 完整描述 "前右2" 存入桌號 1 欄位
   ```

2. **時間安全處理**:
   ```javascript
   // 自動處理無效時間值，使用當前時間作為備用
   ```

3. **欄位類型精確匹配**:
   - 桌號資料庫: 桌號為 Title 類型
   - 訂單資料庫: 桌號為 Number 類型，訂單編號為 Title 類型
   - 菜單資料庫: 分類為 Select 類型 (不是 Rich Text)

4. **完整欄位支援**:
   - 支援所有實際存在的 Notion 欄位
   - 向下相容現有代碼的欄位名稱

---

## ✅ 驗證測試

1. **桌況查詢**: ✅ 成功讀取桌況資料
2. **菜單載入**: ✅ 成功讀取菜單資料
3. **訂單建立**: 🧪 等待測試

---

## 🚀 使用方式

POS 系統現在可以:
1. 自動適應 Notion 資料庫的實際結構
2. 智能處理各種桌號格式 ("前右2", "方6", "1", "VIP3" 等)
3. 安全處理時間和數據類型轉換
4. 完整同步所有相關欄位到 Notion

**建議**: 在生產環境中測試完整的訂單流程，確保所有欄位正確同步。
